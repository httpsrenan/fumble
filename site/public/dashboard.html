<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>FUMBLE - Dasboard</title>

    <link rel="stylesheet" href="dstyle.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="icon" href="img/logo.png" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <!--header inicio-->
    <div class="header">
        <div class="container">
            <img src="img/logo_fumle.png" width="85px">
            <ul class="navbar">
                <li><a href="index.html">Menu</li>
                <li><a href="times.html">Times</a></li>
                <li><a href="historia.html">História</a></li>
                <li><a href="regras.html">Regras</a></li>
                <li><a href="noticias.html">Notícias</a></li>
                <li><button class="login" onclick="login()">Login</button></li>
                <li><button class="cadastro"  onclick="cadastro()">Cadastrar</button></li>
            </ul>
        </div>
    </div>

    <!--header fim-->

    <h1 style="color: white;">Dashboard de Controle</h1>

    <div class="graficos-container">

        <div class="grafico">
            <h2 style="color: white;"> ↑ 10 Times mais favoritados</h2>
            <canvas id="graficoMaisFavoritados"></canvas>
        </div>

        <div class="grafico">
            <h2 style="color: white;"> ↓ 10 Times menos favoritados</h2>
            <canvas id="graficoMenosFavoritados"></canvas>
        </div>
        
        <br><br><br>

        <div class="grafico">
            <h2 style="color: white;"> 5 Usuários que mais favoritaram times</h2>
            <canvas id="graficoUsuariosMaisFavoritaram" ></canvas>
        </div>

        <div class="grafico" style="max-width: 500px; max-height: 500px;">
            <h2 style="color: white;">AFC X NFC</h2>
            <canvas id="conferencia" style="max-width: 500px; max-height: 400px;"></canvas>
        </div>


    </div>
    <!--footer inicio-->

    <div class="footer">
        <div class="container">
            <div class="conteudo">
                <img src="img/logo_fumle.png" width="70px">
                <div class="redes-sociais">
                    <img src="img/instax.png" alt="Instagram" width="30px">

</body>
<script>
    function login() {
        window.location.href = "login.html"
    }

    function cadastrar() {
        window.location.href = "cadastro.html"
    }

    async function gerarGraficos() {

        const dadosMais = await fetch("/dashboard/mais-favoritados").then(res => res.json());
        new Chart(document.getElementById("graficoMaisFavoritados"), {
            type: "bar",
            data: {
                labels: dadosMais.map(item => item.nome),
                datasets: [{
                    label: "Favoritos",
                    data: dadosMais.map(item => item.total_favoritos),
                    backgroundColor: "rgba(75, 192, 192, 0.6)"
                }]
            }
        });

        const dadosMenos = await fetch("/dashboard/menos-favoritados").then(res => res.json());
        new Chart(document.getElementById("graficoMenosFavoritados"), {
            type: "bar",
            data: {
                labels: dadosMenos.map(item => item.nome),
                datasets: [{
                    label: "Favoritos",
                    data: dadosMenos.map(item => item.total_favoritos),
                    backgroundColor: "rgba(255, 99, 132, 0.6)"
                }]
            }
        });


        const dadosUsuarios = await fetch("/dashboard/usuarios-mais-favoritaram").then(res => res.json());
        new Chart(document.getElementById("graficoUsuariosMaisFavoritaram"), {
            type: "bar",
            data: {
                labels: dadosUsuarios.map(item => item.nome),
                datasets: [{
                    label: "Favoritos realizados",
                    data: dadosUsuarios.map(item => item.total_favoritos),
                    backgroundColor: "rgba(54, 162, 235, 0.6)"
                }]
            }
        });


        const dadosConferencia = await fetch("/dashboard/favoritos-por-conferencia").then(res => res.json());
        new Chart(document.getElementById("conferencia"), {
            type: "pie",
            data: {
                labels: dadosConferencia.map(item => item.conferencia),
                datasets: [{
                    label: "AFC X NFC",
                    data: dadosConferencia.map(item => item.total_favoritos),
                    backgroundColor: [
                        "#d10e1e",
                        "#003a68"
                    ]
                }]
            }
        });
    }

    gerarGraficos();
</script>

</html>